# Shellå·¥å…·é…ç½®æ¨¡å—ç»¼åˆæµ‹è¯•ç”¨ä¾‹è§„èŒƒ

## ğŸ¯ æµ‹è¯•ç”¨ä¾‹è®¾è®¡åŸåˆ™

### æµ‹è¯•ç”¨ä¾‹åˆ†ç±»
1. **æ­£å¸¸åŠŸèƒ½æµ‹è¯•** - éªŒè¯æ ‡å‡†ä½¿ç”¨åœºæ™¯ä¸‹çš„åŠŸèƒ½æ­£ç¡®æ€§
2. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•** - æµ‹è¯•æé™æƒ…å†µå’Œè¾¹ç•Œå€¼å¤„ç†
3. **é”™è¯¯å¤„ç†æµ‹è¯•** - éªŒè¯å¼‚å¸¸æƒ…å†µä¸‹çš„é”™è¯¯å¤„ç†æœºåˆ¶
4. **å…¼å®¹æ€§æµ‹è¯•** - ç¡®ä¿åœ¨ä¸åŒç¯å¢ƒä¸‹çš„å…¼å®¹æ€§
5. **æ€§èƒ½æµ‹è¯•** - éªŒè¯åŠŸèƒ½æ‰§è¡Œæ•ˆç‡å’Œèµ„æºä½¿ç”¨

### æµ‹è¯•ç”¨ä¾‹æ ‡å‡†æ ¼å¼
```
æµ‹è¯•ç”¨ä¾‹ID: TC-[æ¨¡å—ç¼–å·]-[ç±»åˆ«]-[åºå·]
æµ‹è¯•åç§°: [ç®€æ´æè¿°æµ‹è¯•ç›®çš„]
æµ‹è¯•ç±»å‹: [æ­£å¸¸/è¾¹ç•Œ/é”™è¯¯/å…¼å®¹æ€§/æ€§èƒ½]
å‰ç½®æ¡ä»¶: [æµ‹è¯•æ‰§è¡Œå‰çš„å¿…è¦æ¡ä»¶]
æµ‹è¯•æ­¥éª¤: [è¯¦ç»†çš„æ‰§è¡Œæ­¥éª¤]
é¢„æœŸç»“æœ: [æ˜ç¡®çš„æˆåŠŸæ ‡å‡†]
æ¸…ç†æ­¥éª¤: [æµ‹è¯•åçš„ç¯å¢ƒæ¸…ç†]
```

## ğŸ“‹ æ¨¡å—03ï¼šfdé…ç½®æµ‹è¯•ç”¨ä¾‹

### TC-03-001ï¼šfdåŸºç¡€åˆ«ååŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fdæˆ–fdfindå·¥å…·å·²å®‰è£…
- å…·æœ‰åˆ›å»ºæµ‹è¯•æ–‡ä»¶çš„æƒé™

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæµ‹è¯•ç›®å½•ç»“æ„
mkdir -p /tmp/fd-test/{dir1,dir2}
touch /tmp/fd-test/file1.txt /tmp/fd-test/dir1/file2.py

2. åŠ è½½fdé…ç½®æ¨¡å—
source templates/03-fd-config.zsh

3. æµ‹è¯•åŸºç¡€åˆ«å
fdf "file1" /tmp/fd-test  # æŸ¥æ‰¾æ–‡ä»¶
fdd "dir1" /tmp/fd-test   # æŸ¥æ‰¾ç›®å½•
fda "file" /tmp/fd-test   # æŸ¥æ‰¾æ‰€æœ‰

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- fdfæ‰¾åˆ°file1.txt
- fddæ‰¾åˆ°dir1ç›®å½•
- fdaæ‰¾åˆ°æ‰€æœ‰åŒ…å«"file"çš„é¡¹ç›®

# æ¸…ç†æ­¥éª¤
rm -rf /tmp/fd-test
```

### TC-03-002ï¼šfd+baté›†æˆåŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fdå’Œbatå·¥å…·éƒ½å·²å®‰è£…
- å…·æœ‰åˆ›å»ºæµ‹è¯•æ–‡ä»¶çš„æƒé™

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "#!/bin/bash\necho 'Hello World'" > /tmp/test-script.sh

2. åŠ è½½fdé…ç½®æ¨¡å—
source templates/03-fd-config.zsh

3. æµ‹è¯•é›†æˆåŠŸèƒ½
fdbat "test-script" /tmp  # fd+baté›†æˆæŸ¥çœ‹

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- è¾“å‡ºåŒ…å«è¯­æ³•é«˜äº®çš„æ–‡ä»¶å†…å®¹
- æ˜¾ç¤ºè¡Œå·å’Œæ–‡ä»¶è·¯å¾„

# æ¸…ç†æ­¥éª¤
rm -f /tmp/test-script.sh
```

### TC-03-003ï¼šfdå·¥å…·ç¼ºå¤±é™çº§æµ‹è¯•ï¼ˆé”™è¯¯å¤„ç†ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- å¯ä»¥ä¸´æ—¶ä¿®æ”¹PATHç¯å¢ƒå˜é‡

# æµ‹è¯•æ­¥éª¤
1. å¤‡ä»½åŸå§‹PATH
original_path="$PATH"

2. éšè—fdå·¥å…·
export PATH="/bin:/usr/bin"

3. åŠ è½½fdé…ç½®æ¨¡å—
output=$(source templates/03-fd-config.zsh 2>&1)

4. æ¢å¤PATH
export PATH="$original_path"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0ï¼ˆä¸åº”å´©æºƒï¼‰
- è¾“å‡ºåŒ…å«å‹å¥½çš„é”™è¯¯æç¤º
- æä¾›å®‰è£…å»ºè®®

# æ¸…ç†æ­¥éª¤
# PATHå·²æ¢å¤ï¼Œæ— éœ€é¢å¤–æ¸…ç†
```

## ğŸ“‹ æ¨¡å—04ï¼šfzfæ ¸å¿ƒé…ç½®æµ‹è¯•ç”¨ä¾‹

### TC-04-001ï¼šfzfç¯å¢ƒå˜é‡é…ç½®æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fzfå·¥å…·å·²å®‰è£…

# æµ‹è¯•æ­¥éª¤
1. åŠ è½½fzfæ ¸å¿ƒé…ç½®æ¨¡å—
source templates/04-fzf-core.zsh

2. éªŒè¯å…³é”®ç¯å¢ƒå˜é‡
echo "$FZF_DEFAULT_OPTS" | grep -q "height=70%"
echo "$FZF_DEFAULT_OPTS" | grep -q "layout=reverse"
echo "$FZF_DEFAULT_OPTS" | grep -q "border"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- FZF_DEFAULT_OPTSåŒ…å«height=70%
- FZF_DEFAULT_OPTSåŒ…å«layout=reverse
- FZF_DEFAULT_OPTSåŒ…å«borderè®¾ç½®
```

### TC-04-002ï¼šfzfæœç´¢å‘½ä»¤é…ç½®æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fzfå’Œfdå·¥å…·éƒ½å·²å®‰è£…

# æµ‹è¯•æ­¥éª¤
1. åŠ è½½fzfæ ¸å¿ƒé…ç½®æ¨¡å—
source templates/04-fzf-core.zsh

2. éªŒè¯æœç´¢å‘½ä»¤è®¾ç½®
[[ -n "$FZF_DEFAULT_COMMAND" ]] || exit 1
[[ -n "$FZF_CTRL_T_COMMAND" ]] || exit 1
[[ -n "$FZF_ALT_C_COMMAND" ]] || exit 1

3. æµ‹è¯•æœç´¢å‘½ä»¤åŠŸèƒ½
eval "$FZF_DEFAULT_COMMAND" | head -5 | wc -l

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- æ‰€æœ‰æœç´¢å‘½ä»¤å˜é‡å·²è®¾ç½®
- æœç´¢å‘½ä»¤èƒ½æ­£å¸¸æ‰§è¡Œ
- è¿”å›æ–‡ä»¶åˆ—è¡¨
```

### TC-04-003ï¼štmuxé›†æˆé…ç½®æµ‹è¯•ï¼ˆå…¼å®¹æ€§ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- åœ¨tmuxç¯å¢ƒä¸­è¿è¡Œæˆ–æ¨¡æ‹Ÿtmuxç¯å¢ƒ

# æµ‹è¯•æ­¥éª¤
1. æ¨¡æ‹Ÿtmuxç¯å¢ƒ
export TMUX="test-session"

2. åŠ è½½fzfæ ¸å¿ƒé…ç½®æ¨¡å—
source templates/04-fzf-core.zsh

3. éªŒè¯tmuxç›¸å…³é…ç½®
[[ -n "$FZF_TMUX_OPTS" ]] || exit 1

4. æ£€æŸ¥tmuxå‡½æ•°å®šä¹‰
declare -f fzf-tmux-center >/dev/null 2>&1

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- FZF_TMUX_OPTSå·²è®¾ç½®
- tmuxç›¸å…³å‡½æ•°å·²å®šä¹‰

# æ¸…ç†æ­¥éª¤
unset TMUX
```

## ğŸ“‹ æ¨¡å—05ï¼šfzfåŸºç¡€åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹

### TC-05-001ï¼šæ–‡ä»¶æœç´¢å’Œç¼–è¾‘åŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fzfã€batå·¥å…·å·²å®‰è£…
- å…·æœ‰åˆ›å»ºå’Œç¼–è¾‘æ–‡ä»¶çš„æƒé™

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "test content" > /tmp/fzf-test-file.txt

2. åŠ è½½fzfåŸºç¡€é…ç½®æ¨¡å—
source templates/05-fzf-basic.zsh

3. éªŒè¯å‡½æ•°å®šä¹‰
declare -f fe >/dev/null 2>&1 || exit 1
declare -f fp >/dev/null 2>&1 || exit 1

4. æµ‹è¯•æ–‡ä»¶é¢„è§ˆåŠŸèƒ½ï¼ˆæ¨¡æ‹Ÿï¼‰
# ç”±äºfzfæ˜¯äº¤äº’å¼çš„ï¼Œæˆ‘ä»¬æµ‹è¯•åº•å±‚å‘½ä»¤
find /tmp -name "*fzf-test*" | head -1

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- feå’Œfpå‡½æ•°å·²å®šä¹‰
- èƒ½æ‰¾åˆ°æµ‹è¯•æ–‡ä»¶

# æ¸…ç†æ­¥éª¤
rm -f /tmp/fzf-test-file.txt
```

### TC-05-002ï¼šå†å²å‘½ä»¤æœç´¢æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fzfå·¥å…·å·²å®‰è£…
- shellå†å²åŠŸèƒ½å¯ç”¨

# æµ‹è¯•æ­¥éª¤
1. æ·»åŠ æµ‹è¯•å‘½ä»¤åˆ°å†å²
echo "test-command-12345" >> ~/.zsh_history

2. åŠ è½½fzfåŸºç¡€é…ç½®æ¨¡å—
source templates/05-fzf-basic.zsh

3. éªŒè¯å†å²æœç´¢å‡½æ•°
declare -f fh >/dev/null 2>&1 || exit 1

4. æµ‹è¯•å†å²æœç´¢ï¼ˆæ¨¡æ‹Ÿï¼‰
history | grep -q "test-command-12345"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- fhå‡½æ•°å·²å®šä¹‰
- å†å²è®°å½•åŒ…å«æµ‹è¯•å‘½ä»¤

# æ¸…ç†æ­¥éª¤
# å†å²è®°å½•ä¼šè‡ªç„¶æ¸…ç†ï¼Œæ— éœ€ç‰¹æ®Šå¤„ç†
```

### TC-05-003ï¼šè¿›ç¨‹ç®¡ç†åŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- fzfå·¥å…·å·²å®‰è£…
- å…·æœ‰æŸ¥çœ‹è¿›ç¨‹çš„æƒé™

# æµ‹è¯•æ­¥éª¤
1. å¯åŠ¨æµ‹è¯•è¿›ç¨‹
sleep 300 &
test_pid=$!

2. åŠ è½½fzfåŸºç¡€é…ç½®æ¨¡å—
source templates/05-fzf-basic.zsh

3. éªŒè¯è¿›ç¨‹ç®¡ç†å‡½æ•°
declare -f fkill >/dev/null 2>&1 || exit 1

4. æµ‹è¯•è¿›ç¨‹æŸ¥æ‰¾
ps aux | grep -q "sleep 300"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- fkillå‡½æ•°å·²å®šä¹‰
- èƒ½æ‰¾åˆ°æµ‹è¯•è¿›ç¨‹

# æ¸…ç†æ­¥éª¤
kill $test_pid 2>/dev/null || true
```

## ğŸ“‹ æ¨¡å—08ï¼šripgrep+fzfé›†æˆæµ‹è¯•ç”¨ä¾‹

### TC-08-001ï¼šäº¤äº’å¼æœç´¢åŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- ripgrepã€fzfã€batå·¥å…·éƒ½å·²å®‰è£…
- å…·æœ‰åˆ›å»ºæµ‹è¯•æ–‡ä»¶çš„æƒé™

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶
mkdir -p /tmp/rg-test
echo "function test_function() { return 0; }" > /tmp/rg-test/test.js
echo "def test_function(): pass" > /tmp/rg-test/test.py

2. åŠ è½½ripgrep+fzfé›†æˆæ¨¡å—
source templates/08-ripgrep-fzf.zsh

3. éªŒè¯é›†æˆå‡½æ•°å®šä¹‰
declare -f rgf >/dev/null 2>&1 || exit 1
declare -f rge >/dev/null 2>&1 || exit 1

4. æµ‹è¯•æœç´¢åŠŸèƒ½ï¼ˆéäº¤äº’å¼éªŒè¯ï¼‰
rg "test_function" /tmp/rg-test | wc -l

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- rgfå’Œrgeå‡½æ•°å·²å®šä¹‰
- æœç´¢æ‰¾åˆ°2ä¸ªåŒ¹é…é¡¹

# æ¸…ç†æ­¥éª¤
rm -rf /tmp/rg-test
```

### TC-08-002ï¼šå¤šæ–‡ä»¶ç±»å‹æœç´¢æµ‹è¯•ï¼ˆæ­£å¸¸åŠŸèƒ½ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- ripgrepã€fzfå·¥å…·å·²å®‰è£…

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºå¤šç±»å‹æµ‹è¯•æ–‡ä»¶
mkdir -p /tmp/multi-test
echo "console.log('hello');" > /tmp/multi-test/app.js
echo "print('hello')" > /tmp/multi-test/app.py
echo "echo 'hello'" > /tmp/multi-test/app.sh

2. åŠ è½½ripgrep+fzfé›†æˆæ¨¡å—
source templates/08-ripgrep-fzf.zsh

3. éªŒè¯å¤šæ–‡ä»¶ç±»å‹æœç´¢å‡½æ•°
declare -f rgm >/dev/null 2>&1 || exit 1

4. æµ‹è¯•å¤šç±»å‹æœç´¢
rg --type js "hello" /tmp/multi-test | wc -l
rg --type py "hello" /tmp/multi-test | wc -l

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- rgmå‡½æ•°å·²å®šä¹‰
- æ¯ç§ç±»å‹éƒ½æ‰¾åˆ°åŒ¹é…é¡¹

# æ¸…ç†æ­¥éª¤
rm -rf /tmp/multi-test
```

### TC-08-003ï¼šæœç´¢æ›¿æ¢é¢„è§ˆæµ‹è¯•ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰
```bash
# å‰ç½®æ¡ä»¶
- ripgrepå·¥å…·å·²å®‰è£…
- å…·æœ‰æ–‡ä»¶å†™å…¥æƒé™

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "old_value = 123" > /tmp/replace-test.txt
echo "old_value = 456" >> /tmp/replace-test.txt

2. åŠ è½½ripgrep+fzfé›†æˆæ¨¡å—
source templates/08-ripgrep-fzf.zsh

3. éªŒè¯æœç´¢æ›¿æ¢å‡½æ•°
declare -f rgs >/dev/null 2>&1 || exit 1

4. æµ‹è¯•æœç´¢åŠŸèƒ½ï¼ˆä¸æ‰§è¡Œæ›¿æ¢ï¼‰
rg "old_value" /tmp/replace-test.txt | wc -l

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- rgså‡½æ•°å·²å®šä¹‰
- æ‰¾åˆ°2ä¸ªåŒ¹é…é¡¹

# æ¸…ç†æ­¥éª¤
rm -f /tmp/replace-test.txt
```

## ğŸ“‹ è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†æµ‹è¯•ç”¨ä¾‹

### TC-EDGE-001ï¼šå¤§æ–‡ä»¶å¤„ç†æ€§èƒ½æµ‹è¯•
```bash
# å‰ç½®æ¡ä»¶
- æ‰€æœ‰ç›¸å…³å·¥å…·å·²å®‰è£…
- å…·æœ‰åˆ›å»ºå¤§æ–‡ä»¶çš„æƒé™å’Œç©ºé—´

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºå¤§æ–‡ä»¶ï¼ˆ10MBï¼‰
dd if=/dev/zero of=/tmp/large-file.txt bs=1M count=10 2>/dev/null
for i in {1..1000}; do echo "line $i with some content" >> /tmp/large-file.txt; done

2. æµ‹è¯•å„å·¥å…·å¤„ç†å¤§æ–‡ä»¶çš„æ€§èƒ½
time bat /tmp/large-file.txt >/dev/null 2>&1
time rg "line 500" /tmp/large-file.txt >/dev/null 2>&1

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- batå¤„ç†æ—¶é—´ < 5ç§’
- rgæœç´¢æ—¶é—´ < 1ç§’

# æ¸…ç†æ­¥éª¤
rm -f /tmp/large-file.txt
```

### TC-EDGE-002ï¼šç‰¹æ®Šå­—ç¬¦å¤„ç†æµ‹è¯•
```bash
# å‰ç½®æ¡ä»¶
- ç›¸å…³å·¥å…·å·²å®‰è£…

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºåŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ–‡ä»¶
echo "æ–‡ä»¶ååŒ…å«ä¸­æ–‡.txt" > "/tmp/æµ‹è¯•æ–‡ä»¶.txt"
echo "content with spaces and symbols: @#$%^&*()" >> "/tmp/æµ‹è¯•æ–‡ä»¶.txt"

2. æµ‹è¯•å·¥å…·å¤„ç†ç‰¹æ®Šå­—ç¬¦
fd "æµ‹è¯•" /tmp
rg "symbols" "/tmp/æµ‹è¯•æ–‡ä»¶.txt"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼š0
- æ­£ç¡®å¤„ç†ä¸­æ–‡æ–‡ä»¶å
- æ­£ç¡®æœç´¢ç‰¹æ®Šå­—ç¬¦å†…å®¹

# æ¸…ç†æ­¥éª¤
rm -f "/tmp/æµ‹è¯•æ–‡ä»¶.txt"
```

### TC-ERROR-001ï¼šæƒé™ä¸è¶³é”™è¯¯å¤„ç†æµ‹è¯•
```bash
# å‰ç½®æ¡ä»¶
- å…·æœ‰åˆ›å»ºæ–‡ä»¶å’Œä¿®æ”¹æƒé™çš„èƒ½åŠ›

# æµ‹è¯•æ­¥éª¤
1. åˆ›å»ºæ— æƒé™è®¿é—®çš„æ–‡ä»¶
echo "restricted content" > /tmp/restricted.txt
chmod 000 /tmp/restricted.txt

2. æµ‹è¯•å·¥å…·çš„é”™è¯¯å¤„ç†
bat /tmp/restricted.txt 2>&1 | grep -q "Permission denied"
rg "content" /tmp/restricted.txt 2>&1 | grep -q "Permission denied"

# é¢„æœŸç»“æœ
- è¿”å›ç ï¼šé0ï¼ˆé¢„æœŸçš„é”™è¯¯ï¼‰
- è¾“å‡ºåŒ…å«æƒé™é”™è¯¯ä¿¡æ¯
- ç¨‹åºä¸ä¼šå´©æºƒ

# æ¸…ç†æ­¥éª¤
chmod 644 /tmp/restricted.txt
rm -f /tmp/restricted.txt
```
